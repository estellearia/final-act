<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pixelated Memories & Aria Message</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

  /* Basic resets and full center */
  html, body {
    margin: 0; padding: 0; height: 100%;
    background: #1b1b2f; /* deep navy/purple */
    font-family: 'Press Start 2P', cursive;
    color: #eee;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
  }

  /* Container for all scenes */
  .container {
    width: 480px;
    min-height: 500px;
    background: linear-gradient(145deg, #2e2e4f, #222240);
    border: 6px solid #8360c3;
    box-shadow:
      0 0 0 4px #9b88e3,
      inset 0 0 8px #7f69d9,
      6px 6px 12px #110e23;
    border-radius: 12px;
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  /* Hide all scenes by default */
  .scene {
    display: none;
    text-align: center;
  }

  /* Show active scene */
  .scene.visible {
    display: block;
  }

  /* Pixel avatar style */
  .avatar {
    width: 96px;
    height: 96px;
    image-rendering: pixelated;
    margin: 0 auto 20px;
    filter: drop-shadow(1px 1px 0 #8360c3);
  }

  /* Mewby intro text styling */
  #mewbyText {
    font-size: 12px;
    line-height: 1.6;
    max-width: 420px;
    margin: 0 auto;
    color: #d9d9ff;
    text-shadow:
      1px 1px 0 #4e47a3,
      0 0 5px #9085f0;
    cursor: pointer;
    user-select: none;
  }
  #mewbyText .typing-cursor {
    display: inline-block;
    width: 8px;
    height: 16px;
    background: #8360c3;
    animation: blink 1s step-start infinite;
    vertical-align: bottom;
    margin-left: 4px;
  }

  @keyframes blink {
    0%, 50% { opacity: 1; }
    50.01%, 100% { opacity: 0; }
  }

  /* Memories scene */
  #memoryFragments {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 18px;
    margin-top: 20px;
  }
  .memory-fragment {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: #4b4399;
    box-shadow:
      0 0 4px 1px #6d66c1,
      inset 0 0 8px #9a94e6;
    cursor: pointer;
    transition: background 0.3s, box-shadow 0.3s;
    border: 2px solid #8360c3;
  }
  .memory-fragment.visited {
    background: #b49aff;
    box-shadow:
      0 0 10px 2px #b49aff,
      inset 0 0 12px #d5c9ff;
    border-color: #d9ccff;
  }
  .memory-fragment:focus {
    outline: 3px solid #d9ccff;
    outline-offset: 2px;
  }

  /* Tooltip styling */
  #tooltip {
    margin-top: 18px;
    font-size: 11px;
    min-height: 28px;
    color: #c1baff;
    text-shadow: 0 0 3px #6a5f9a;
    opacity: 0.7;
    transition: opacity 0.3s;
    max-width: 440px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Next button */
  #memoriesNext {
    margin-top: 28px;
    padding: 10px 18px;
    font-size: 10px;
    font-family: 'Press Start 2P', cursive;
    background: #5f53a6;
    border: 3px solid #8360c3;
    color: #e6dcff;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s, color 0.3s;
    user-select: none;
  }
  #memoriesNext:disabled {
    opacity: 0.3;
    cursor: default;
  }
  #memoriesNext:not(:disabled):hover {
    background: #8e81e9;
    color: #fff;
  }

  /* FINAL ARIA SCENE */

  /* Sparkle background */
  .sparkle-bg {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background:
      radial-gradient(circle at 20% 25%, #a29bff 2px, transparent 6px),
      radial-gradient(circle at 50% 50%, #7a6eff 1.5px, transparent 5px),
      radial-gradient(circle at 80% 70%, #b8aaff 2px, transparent 6px);
    background-repeat: no-repeat;
    animation: sparkleMove 8s linear infinite;
    z-index: -1;
  }
  @keyframes sparkleMove {
    0% { background-position: 20% 25%, 50% 50%, 80% 70%; }
    50% { background-position: 30% 35%, 40% 40%, 85% 65%; }
    100% { background-position: 20% 25%, 50% 50%, 80% 70%; }
  }

  #ariaScene {
    position: relative;
    padding: 0 24px 24px;
    min-height: 400px;
    color: #d6d0ff;
    text-shadow:
      1px 1px 3px #433b77;
    user-select: text;
  }

  .aria-sprite {
    image-rendering: pixelated;
    width: 96px;
    height: 96px;
    margin: 0 auto 20px;
    filter: drop-shadow(1px 1px 1px #8360c3);
    display: block;
  }

  #ariaText {
    font-size: 11px;
    line-height: 1.5;
    white-space: pre-wrap;
    max-width: 440px;
    margin: 0 auto;
    background: #2f2e4a;
    border: 3px solid #9a8cfc;
    border-radius: 10px;
    padding: 18px 16px;
    box-shadow:
      inset 0 0 14px #8f7bef,
      0 0 8px #7d71e8;
  }

  #endButton {
    font-family: 'Press Start 2P', cursive;
    font-size: 10px;
    margin: 28px auto 0;
    display: inline-block;
    padding: 12px 24px;
    background: #7c72e0;
    border: 4px solid #b3a9ff;
    border-radius: 8px;
    color: #e0d9ff;
    cursor: pointer;
    box-shadow: 0 0 6px #b9afff;
    transition: background 0.3s ease;
    user-select: none;
  }
  #endButton:hover {
    background: #a7a1f7;
  }
</style>
</head>
<body>
  <div class="container">

    <!-- 1. MEWBY INTRO SCENE WITH TYPING EFFECT -->
    <div id="mewby" class="scene visible" aria-live="polite" role="region" aria-label="Mewby Introduction">
      <img src="https://i.imgur.com/qpJz0Ro.gif" alt="Mewby pixel avatar" class="avatar" />
      <div id="mewbyText" aria-live="polite" aria-atomic="true" role="textbox" tabindex="0"></div>
    </div>

    <!-- 2. MEMORIES SCENE -->
    <div id="memories" class="scene" aria-live="polite" role="region" aria-label="Memories Scene">
      <h2 style="font-size: 12px; margin-bottom: 8px; color:#d1caff; text-shadow: 1px 1px 3px #443f7a;">Your memories with me</h2>
      <div id="memoryFragments" aria-label="Memory fragments, click each to reveal description"></div>
      <div id="tooltip" aria-live="polite" role="alert" aria-atomic="true"></div>
      <button class="pixel-button" id="memoriesNext" aria-label="Next to final scene">Next</button>
    </div>

    <!-- 3. FINAL CHOOSEHER SCENE -->
    <div id="ariaScene" class="scene" aria-live="polite" role="region" aria-label="Final scene with Aria">
      <div class="sparkle-bg" aria-hidden="true"></div>
      <img src="https://i.imgur.com/9OC7GRw.gif" alt="Aria avatar" class="aria-sprite" />
      <div id="ariaText" aria-atomic="true" aria-live="polite" tabindex="0"></div>
      <button id="endButton" class="pixel-button" style="display:none;">End</button>
    </div>
  </div>

<script>
  /* ====== 1. MEWBY INTRO TYPING ====== */
  const mewbyTextEl = document.getElementById('mewbyText');
  const mewbyLines = [
    "Hey! I'm Mewby, your guide.",
    "Weâ€™re about to take a little walk through memories and moments between us.",
    "Click to start your journey."
  ];

  // Typewriter effect function for Mewby intro text
  function typeWriter(element, text, speed = 40) {
    return new Promise((resolve) => {
      let i = 0;
      element.textContent = '';
      function typing() {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          setTimeout(typing, speed);
        } else {
          resolve();
        }
      }
      typing();
    });
  }

  async function playMewbyIntro() {
    for (const line of mewbyLines) {
      await typeWriter(mewbyTextEl, line);
      await new Promise(r => setTimeout(r, 700));
    }
    mewbyTextEl.innerHTML += ' <span class="typing-cursor"></span>';
  }

  // On click anywhere in #mewby, go to memories scene
  document.getElementById('mewby').addEventListener('click', () => {
    document.getElementById('mewby').classList.remove('visible');
    document.getElementById('memories').classList.add('visible');
    initMemories();
  });

  playMewbyIntro();

  /* ====== 2. MEMORIES SCENE ====== */
  const memoriesData = [
    { title: "First time we talked", desc: "That night when we stayed up late, just talking.", visited: false },
    { title: "Hospital visit", desc: "When I was sick and you stayed by my side.", visited: false },
    { title: "Long distance calls", desc: "Our endless phone calls across the miles.", visited: false },
    { title: "Work stress days", desc: "You encouraged me even on my worst days.", visited: false },
    { title: "Our first video game night", desc: "Laughing and playing like no distance existed.", visited: false },
    { title: "The first 'I love you'", desc: "That shy, unforgettable moment.", visited: false },
  ];

  const memoryFragmentsEl = document.getElementById('memoryFragments');
  const tooltipEl = document.getElementById('tooltip');
  const memoriesNextBtn = document.getElementById('memoriesNext');

  function initMemories() {
    // Clear previous
    memoryFragmentsEl.innerHTML = '';
    tooltipEl.textContent = "Click each memory fragment to reveal it.";
    memoriesNextBtn.disabled = true;

    memoriesData.forEach((mem, i) => {
      const frag = document.createElement('button');
      frag.className = 'memory-fragment';
      frag.setAttribute('aria-label', `Memory fragment: ${mem.title}`);
      frag.setAttribute('tabindex', '0');
      frag.addEventListener('click', () => {
        if (!mem.visited) {
          mem.visited = true;
          frag.classList.add('visited');
          tooltipEl.textContent = mem.desc;
          checkAllVisited();
        }
      });
      memoryFragmentsEl.appendChild(frag);
    });
  }

  function checkAllVisited() {
    if (memoriesData.every(m => m.visited)) {
      memoriesNextBtn.disabled = false;
      tooltipEl.textContent = "All memories revealed! Click Next to continue.";
    }
  }

  memoriesNextBtn.addEventListener('click', () => {
    document.getElementById('memories').classList.remove('visible');
    showAriaMessage();
  });

  /* ====== 3. FINAL ARIA MESSAGE ====== */

  const ariaTextEl = document.getElementById('ariaText');
  const ariaSceneEl = document.getElementById('ariaScene');
  const endButton = document.getElementById('endButton');

  const ariaMessage = `\n  I know itâ€™s been a tough journey.\n\n
  I see your strengthâ€”the way you always put others first, the way you keep going even when things get hard.\n\n
  You are the most hardworking person Iâ€™ve ever known.\n\n
  Sometimes I wish youâ€™d choose yourself, just as I choose you every day.\n\n
  Through distance, through challenges,\n
  no matter what comes,\n
  I will always choose you.\n\n
  Thank you for being my safe place.`;

  function showAriaMessage() {
    ariaSceneEl.classList.add('visible');
    ariaTextEl.textContent = ariaMessage.trim();
    ariaTextEl.focus();
    endButton.style.display = 'inline-block';
  }

  endButton.addEventListener('click', () => {
    alert('Thank you for sharing this moment ðŸ’œ');
  });
</script>
</body>
</html>
