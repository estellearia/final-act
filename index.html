-- final act

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Always Choose Her</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
    html, body {
      height: 100%;
      background: radial-gradient(ellipse at 50% 75%, #353a5c 0%, #141332 70%, #06061a 100%);
      margin: 0;
      padding: 0;
      width: 100vw;
      min-height: 100vh;
      color: #fff8e7;
      font-family: 'Press Start 2P', monospace;
      overflow-x: hidden;
    }
    body {
      min-height: 100vh;
      min-width: 100vw;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      background-image:
        repeating-linear-gradient(0deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 8px),
        repeating-linear-gradient(90deg, rgba(255,255,255,0.025) 0 1px, transparent 1px 8px);
    }
    .pixel-frame {
      position: relative;
      padding: 34px 20px;
      background: rgba(20,16,40,0.93);
      border-radius: 16px;
      box-shadow:
        0 0 0 3px #ffe76480,
        0 0 0 6px #353a5c,
        0 0 50px 8px #0a0a1a77,
        0 0 0 1.5px #ffe764;
      margin: 0 auto;
      max-width: 350px;
      min-width: 0;
      min-height: 230px;
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 10;
      image-rendering: pixelated;
    }
    @media (max-width: 500px) {
      .pixel-frame { max-width: 98vw; padding: 10vw 1vw; }
    }
    .avatar {
      width: 64px;
      height: 64px;
      image-rendering: pixelated;
      display: block;
      margin: 0 auto 16px auto;
      border-radius: 8px;
      box-shadow: 0 0 12px #ffe76466, 0 0 0 2px #ffe764;
      border: 1px solid #ffe764;
      background: #191830;
    }
    .pixel-text {
      color: #fffbe3;
      text-shadow: 1px 1px 0 #353a5c, 0 0 6px #ffe7646b;
      font-size: 10px;
      margin: 0.7em 0 0.4em 0;
      line-height: 1.6;
      letter-spacing: 1.1px;
      font-family: 'Press Start 2P', monospace;
      word-break: break-word;
    }
    .pixel-quote {
      color: #ffe764;
      font-size: 10px;
      margin-top: 1.3em;
      margin-bottom: 0.6em;
      text-shadow: 1px 1px 0 #353a5c, 0 0 7px #fffbe3b5;
      background: rgba(38, 39, 80, 0.44);
      border-radius: 4px;
      padding: 7px 11px;
      border: 1px solid #ffe76455;
      display: inline-block;
      font-style: italic;
      image-rendering: pixelated;
    }
    .button, .pixel-button {
      font-family: 'Press Start 2P', monospace;
      background: repeating-linear-gradient(135deg, #191830 0 5px, #ffe764 5px 7px, #191830 7px 14px);
      color: #ffe764;
      border: 2px solid #ffe764;
      border-radius: 5px;
      box-shadow: 0 0 6px #ffe76470, 0 2px 0 0 #353a5c;
      padding: 7px 19px;
      cursor: pointer;
      margin: 26px 0 0 0;
      font-size: 10px;
      font-weight: bold;
      text-shadow: 1px 1px 0 #353a5c, 0 0 6px #fffbe3b5;
      letter-spacing: 1.5px;
      transition: background 0.13s, color 0.13s, border-color 0.13s, transform 0.07s;
      image-rendering: pixelated;
      position: relative;
      z-index: 1;
    }
    .button:hover, .pixel-button:hover {
      background: #ffe764;
      color: #191830;
      border-color: #fffbe3;
      transform: scale(1.05) translateY(-1px);
      box-shadow: 0 0 14px #ffe764ad, 0 4px 0 0 #353a5c;
    }
    /* Star bg */
    .pixel-bg-stars {
      position: absolute;
      top: 0; left: 0; width: 100vw; height: 100vh;
      z-index: 0;
      pointer-events: none;
      overflow: hidden;
    }
    .pixel-star {
      position: absolute;
      width: 3px; height: 3px;
      background: #ffe764;
      border-radius: 1px;
      opacity: 0.7;
      box-shadow: 0 0 7px #ffe764aa, 0 0 0 1.5px #fffbe3;
      image-rendering: pixelated;
      animation: pixel-star-blink 2.5s linear infinite;
    }
    @keyframes pixel-star-blink {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
      70% { opacity: 0.5; }
    }
    .aria-box {
      background: rgba(38, 39, 80, 0.56);
      border-radius: 7px;
      padding: 15px 12px 14px 12px;
      margin: 14px 0 0 0;
      box-shadow: 0 0 7px #ffe76422;
      font-size: 10px;
      color: #ffeebc;
      text-shadow: 0 0 4px #ffe76444, 1px 1px 0 #353a5c;
      border: 1px solid #ffe76444;
      font-family: 'Press Start 2P', monospace;
      white-space: pre-line;
      line-height: 1.7;
    }
    #ariaSprite {
      width: 54px;
      height: 54px;
      display: block;
      margin: 0 auto 7px auto;
      border-radius: 5px;
      background: #191830;
      border: 1px solid #ffe764;
      box-shadow: 0 0 10px #ffe76455, 0 0 0 1px #ffe764;
      image-rendering: pixelated;
    }
    .centered {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .hidden { display: none; }
    /* Custom scrollbar for aria */
    .aria-box::-webkit-scrollbar {
      width: 6px;
      background: #222;
    }
    .aria-box::-webkit-scrollbar-thumb {
      background: #ffe76466;
      border-radius: 6px;
    }
    .star-canvas {
      position: absolute;
      left: 0; top: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }
    .memory-fragment {
      width: 36px;
      height: 36px;
      background: linear-gradient(145deg, #fffbe3 30%, #fcd34d 80%);
      border-radius: 50%;
      margin: 32px 22px;
      display: inline-block;
      animation: glow 1.9s infinite alternate;
      cursor: pointer;
      position: relative;
      z-index: 2;
      box-shadow: 0 0 12px #fffbe3, 0 0 40px #ffe764;
      transition: box-shadow 0.3s, transform 0.2s;
      outline: 2px solid #fffbe3;
      outline-offset: 2px;
    }
    .memory-fragment:hover, .memory-fragment:focus {
      box-shadow: 0 0 26px #ffe764, 0 0 70px #fcd34d;
      transform: scale(1.13);
      z-index: 3;
    }
    .memory-fragment.visited {
      opacity: 0.24;
      pointer-events: none;
      box-shadow: none;
      outline: 1px dashed #ffe764;
      background: #282840;
      transition: opacity 0.5s;
    }
  </style>
</head>
<body>
  <div class="pixel-bg-stars" id="pixelBgStars"></div>

  <!-- Main pixel frame -->
  <div class="pixel-frame" id="mainFrame">
    <img src="https://64.media.tumblr.com/647ca06c5a608d1ea1c416b21b839ea3/9a98a57c72a06121-2a/s250x400/7f925df3ce70975efc97a7f0ffac27ea3838ae3e.gif"
      alt="Mewby" class="avatar" id="mainAvatar" />
    <p id="mewbyGreeting" class="pixel-text" style="min-height: 1.5em"></p>
    <p id="mewbyQuote" class="pixel-quote"></p>
    <button class="button" id="mewbyContinue" style="display:none;">Continue</button>
  </div>

  <!-- 2. MEMORIES SCENE -->
  <div class="pixel-frame hidden" id="memoriesFrame">
    <canvas id="starCanvas" class="star-canvas"></canvas>
    <h2 style="font-size: 14px; margin-bottom: 8px; color: #ffe764; text-shadow: 0 0 7px #fffbe3;">Your memories with me</h2>
    <div id="memoryFragments" style="max-width: 480px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: center; gap: 20px;">
      <!-- Memory fragments circles inserted here by JS -->
    </div>
    <div id="tooltip" aria-live="polite" role="alert" aria-atomic="true"></div>
    <button class="button" id="memoriesNext" aria-label="Next to final scene" style="opacity:0.3;" disabled>Next</button>
  </div>

  <!-- Final Choice Scene -->
  <div class="pixel-frame hidden" id="finalFrame">
    <p class="pixel-text">You've remembered enough. What will you do?</p>
    <button class="button" id="chooseEasyBtn" onclick="chooseEasy()">Choose Easy</button>
    <button class="button" id="chooseHerBtn" onclick="chooseHer()">Choose Her</button>
  </div>

  <!-- Aria message frame (hidden by default) -->
  <div class="pixel-frame centered hidden" id="ariaFrame">
    <img src="https://i.imgur.com/9OC7GRw.gif" alt="Aria" id="ariaSprite" />
    <div class="aria-box" id="ariaMsg"></div>
    <button class="pixel-button" onclick="window.location.href='https://frdffsdx.carrd.co/#home';" style="margin-top:16px;">
      return home
    </button>
  </div>

  <script>
    // Pixel background stars
    function drawPixelStars() {
      const bg = document.getElementById('pixelBgStars');
      bg.innerHTML = '';
      let w = window.innerWidth, h = window.innerHeight;
      let n = Math.min(Math.floor(w * h / 4400), 24);
      for (let i = 0; i < n; i++) {
        const star = document.createElement('div');
        star.className = 'pixel-star';
        const left = Math.random() * 92 + 3, top = Math.random() * 83 + 8;
        star.style.left = left + 'vw';
        star.style.top = top + 'vh';
        star.style.width = star.style.height = (Math.random() < 0.75 ? 2 : 3) + 'px';
        star.style.opacity = (Math.random() * 0.7 + 0.2);
        star.style.animationDelay = (Math.random() * 2.5) + "s";
        bg.appendChild(star);
      }
    }
    window.addEventListener('resize', drawPixelStars);

    // Mewby intro typing effect
    const mewbyGreetingText = "Hey! Mewby is herwe!";
    const mewbyQuoteText = "We’re about to take a little walk through memories and moments between you and Aria.\nClick to start your journey.";
    let mewbyGreetingIndex = 0, mewbyQuoteIndex = 0;
    function typeMewbyGreeting() {
      const el = document.getElementById('mewbyGreeting');
      if (mewbyGreetingIndex < mewbyGreetingText.length) {
        el.textContent += mewbyGreetingText[mewbyGreetingIndex++];
        setTimeout(typeMewbyGreeting, 30);
      } else {
        setTimeout(() => { typeMewbyQuote(); }, 440);
      }
    }
    function typeMewbyQuote() {
      const el = document.getElementById('mewbyQuote');
      if (mewbyQuoteIndex < mewbyQuoteText.length) {
        el.textContent += mewbyQuoteText[mewbyQuoteIndex++];
        setTimeout(typeMewbyQuote, 17);
      } else {
        setTimeout(() => {
          document.getElementById('mewbyContinue').style.display = 'inline-block';
        }, 400);
      }
    }
    window.addEventListener("DOMContentLoaded", () => {
      typeMewbyGreeting();
      drawPixelStars();
    });

    document.getElementById('mewbyContinue').onclick = showMemoryLane;

    // MEMORY LANE DATA
    const memoriesData = [
      { title: "First time we talked", desc: "That night when we stayed up late, just talking.", visited: false },
      { title: "Hospital visit", desc: "When I was sick and you stayed by my side.", visited: false },
      { title: "Long distance calls", desc: "Our endless phone calls across the miles.", visited: false },
      { title: "Work stress days", desc: "You encouraged me even on my worst days.", visited: false },
      { title: "Our first video game night", desc: "Laughing and playing like no distance existed.", visited: false },
      { title: "The first 'I love you'", desc: "That shy, unforgettable moment.", visited: false }
    ];

    function showMemoryLane() {
      document.getElementById('mainFrame').classList.add('hidden');
      document.getElementById('memoriesFrame').classList.remove('hidden');
      initMemories();
    }

    function drawStars() {
      const canvas = document.getElementById('starCanvas');
      if (!canvas) return;
      const parent = document.getElementById('memoriesFrame');
      canvas.width = parent.offsetWidth;
      canvas.height = 340;
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0,0,canvas.width,canvas.height);

      for (let i = 0; i < 55; i++) {
        const x = Math.random() * canvas.width;
        const y = Math.random() * canvas.height * 0.9 + 5;
        const size = Math.random() < 0.8 ? 2 : 4;
        ctx.save();
        ctx.globalAlpha = Math.random() * 0.4 + 0.5;
        ctx.fillStyle = Math.random() > 0.5 ? "#ffe764" : "#fffbe3";
        ctx.beginPath();
        ctx.arc(Math.floor(x), Math.floor(y), size, 0, 2 * Math.PI);
        ctx.fill();
        ctx.restore();
      }
    }
    window.addEventListener('resize', drawStars);

    function initMemories() {
      drawStars();
      const memoryFragmentsEl = document.getElementById('memoryFragments');
      const tooltipEl = document.getElementById('tooltip');
      const memoriesNextBtn = document.getElementById('memoriesNext');
      memoryFragmentsEl.innerHTML = '';
      memoriesData.forEach((memory, i) => {
        const circle = document.createElement('div');
        circle.className = 'memory-fragment';
        circle.tabIndex = 0;
        circle.setAttribute('role', 'button');
        circle.setAttribute('aria-label', `${memory.title} memory`);
        circle.dataset.index = i;

        circle.addEventListener('mouseenter', () => {
          if (!memory.visited) {
            tooltipEl.textContent = memory.title;
            tooltipEl.style.opacity = '1';
          }
        });
        circle.addEventListener('mouseleave', () => {
          if (!memory.visited) {
            tooltipEl.textContent = '';
            tooltipEl.style.opacity = '0.5';
          }
        });

        circle.addEventListener('click', () => {
          if (memory.visited) return;
          memory.visited = true;
          circle.classList.add('visited');
          tooltipEl.textContent = memory.desc;
          tooltipEl.style.opacity = '1';

          // If all visited, enable Next button
          if (memoriesData.every(m => m.visited)) {
            memoriesNextBtn.disabled = false;
            memoriesNextBtn.style.opacity = 1;
            memoriesNextBtn.setAttribute('aria-disabled', 'false');
          }
        });

        // Keyboard accessibility: Enter or Space triggers click
        circle.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            circle.click();
          }
        });

        memoryFragmentsEl.appendChild(circle);
      });

      tooltipEl.textContent = '';
      tooltipEl.style.opacity = '0.5';
      memoriesNextBtn.disabled = true;
      memoriesNextBtn.style.opacity = 0.3;
      memoriesNextBtn.setAttribute('aria-disabled', 'true');

      memoriesNextBtn.onclick = () => {
        document.getElementById('memoriesFrame').classList.add('hidden');
        document.getElementById('finalFrame').classList.remove('hidden');
      };
    }

    // FINAL CHOICE
    function chooseHer() {
      document.getElementById("chooseHerBtn").style.display = "none";
      document.getElementById("chooseEasyBtn").style.display = "none";
      showAriaMessage();
    }
    function chooseEasy() {
      alert("You chose the easy way out... But this story is about choosing love.");
    }

    // ARIA MESSAGE
    const ariaMessage = `You made it.

After everything.
Even after how messy things got before.

I still remember how it all fell apart —
the group, the friendships, everything.

Back then, it hurt.
And we didn’t really talk.

But somehow… you came back into my life.
And when you did,
I saw you in a way I hadn’t before.

That’s when everything changed.
That’s when we started.

And honestly…
Even if it means going through all the hard parts again,
I’d still choose this.
I’d still choose you.

Because being with you —
even on the hardest days —
means more than any easy version of life without you.

Thank you for loving me when I shut down.
When I cry out of nowhere.
When I’m not making sense.

You love me on my worst days just as much as my best —
and that means everything to me.

Some people only want love when it's simple.
But I’d go through the hard stuff all over again,
as long as it leads me to you.

You’re my home now.
My everything.

And just this once…
I hope you choose you, too.

Because I’ll keep choosing you.
Every time.

Happy Birthday.
Thank you for coming back.
Thank you for letting me love you now.`;

    function showAriaMessage() {
      document.getElementById('finalFrame').classList.add('hidden');
      document.getElementById('ariaFrame').classList.remove('hidden');
      document.getElementById('ariaFrame').scrollIntoView({behavior:'smooth'});
      const box = document.getElementById('ariaMsg');
      box.textContent = "";
      let idx = 0;
      function typeAria() {
        if(idx <= ariaMessage.length){
          box.textContent = ariaMessage.substring(0, idx);
          idx++;
          setTimeout(typeAria, 10);
        }
      }
      typeAria();
    }
  </script>
</body>
</html>
