<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Always Choose Her</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
    html, body {
      min-height: 100vh;
      min-width: 100vw;
      background: radial-gradient(ellipse at 50% 75%, #353a5c 0%, #141332 70%, #06061a 100%);
      color: #fff8e7;
      font-family: 'Press Start 2P', monospace;
      margin: 0; padding: 0; overflow-x: hidden; font-size: 13px; text-align: center;
    }
    body {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      background-image:
        repeating-linear-gradient(0deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 8px),
        repeating-linear-gradient(90deg, rgba(255,255,255,0.025) 0 1px, transparent 1px 8px);
      min-height: 100vh; min-width: 100vw; text-align: center;
    }
    .hidden { display: none !important; }
    .memory-title {
      font-size: 16px;
      color: #ffe764;
      text-shadow: 0 0 10px #fffbe3, 0 0 8px #ffe764b5;
      font-family: 'Press Start 2P', monospace;
      font-weight: normal;
      letter-spacing: 0.6px;
      margin-bottom: 8px;
      margin-top: 24px;
      text-align: center;
      user-select: none;
      line-height: 1.25;
    }
    #memoryInstructionLines {
      width: 100%;
      max-width: 360px;
      margin: 0 auto 14px auto;
      display: block;
      text-align: center;
    }
    .memory-instruction-quote {
      color: #ffe764;
      font-size: 0.64em;
      background: rgba(38, 39, 80, 0.44);
      border-radius: 4px;
      padding: 9px 10px 8px 10px;
      border: 1px solid #ffe76455;
      display: inline-block;
      font-style: italic;
      image-rendering: pixelated;
      font-weight: normal;
      letter-spacing: 0.5px;
      line-height: 1.8;
      white-space: pre-line;
      text-align: center;
      margin: 0 auto 0 auto;
      user-select: none;
      box-shadow: 0 0 6px #ffe7641c;
    }
    .pixel-frame {
      background: rgba(20,16,40,0.93);
      border-radius: 16px;
      box-shadow: 0 0 0 3px #ffe76480, 0 0 0 6px #353a5c, 0 0 50px 8px #0a0a1a77, 0 0 0 1.5px #ffe764;
      max-width: 370px;
      width: 100%;
      margin: 0 auto;
      margin-top: 0;
      margin-bottom: 25px;
      image-rendering: pixelated;
      padding: 22px 12px 18px 12px;
      box-sizing: border-box;
      position: relative;
      display: block;
      text-align: center;
    }
    @media (max-width: 500px) {
      .pixel-frame { max-width: 98vw; padding: 7vw 1vw; }
      .memory-title { font-size: 13px; }
      #memoryInstructionLines { max-width: 98vw; }
    }
    .avatar {
      width: 54px;
      height: 54px;
      display: block;
      margin: 0 auto 16px auto;
      border-radius: 8px;
      box-shadow: 0 0 12px #ffe76466, 0 0 0 2px #ffe764;
      border: 1px solid #ffe764;
      background: #191830;
      image-rendering: pixelated;
      margin-bottom: 10px;
    }
    .pixel-text {
      color: #fffbe3;
      text-shadow: 1px 1px 0 #353a5c, 0 0 6px #ffe7646b;
      font-size: 0.72em;
      margin: 0.7em 0 0.4em 0;
      line-height: 1.7;
      letter-spacing: 0.7px;
      font-family: 'Press Start 2P', monospace;
      word-break: break-word;
      font-weight: normal;
      text-align: center;
    }
    .pixel-quote {
      color: #ffe764;
      font-size: 0.64em;
      margin-top: 1em;
      margin-bottom: 0.4em;
      text-shadow: 1px 1px 0 #353a5c, 0 0 7px #fffbe3b5;
      background: rgba(38, 39, 80, 0.44);
      border-radius: 4px;
      padding: 5px 8px;
      border: 1px solid #ffe76455;
      display: inline-block;
      font-style: italic;
      image-rendering: pixelated;
      font-weight: normal;
      letter-spacing: 0.5px;
      line-height: 1.9;
      white-space: pre-line;
      text-align: center;
    }
    .button, .pixel-button {
      font-family: 'Press Start 2P', monospace;
      background: #191830;
      color: #ffe764;
      border: 2px solid #ffe764;
      border-radius: 6px;
      box-shadow: 0 2px 0 0 #353a5c, 0 0 8px #ffe76470 inset;
      padding: 4px 10px 4px 10px;
      cursor: pointer;
      margin: 13px 0 0 0;
      font-size: 10px;
      font-weight: normal;
      letter-spacing: 0.7px;
      text-shadow: 1px 1px 0 #353a5c, 0 0 4px #fffbe3b5;
      transition: background 0.16s, color 0.13s, border-color 0.13s, transform 0.07s;
      image-rendering: pixelated;
      position: relative;
      z-index: 1;
      outline: 0;
      min-width: 70px;
      min-height: 26px;;
      text-align: center;
      display: inline-block;
    }
    .button:hover, .pixel-button:hover {
      background: #ffe764;
      color: #191830;
      border-color: #fffbe3;
      transform: scale(1.07) translateY(-1px);
      box-shadow: 0 0 14px #ffe764ad, 0 3px 0 0 #353a5c;
    }
    .center-btn, .mewby-center-btn, .aria-btn-center {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      text-align: center;
    }
    .center-btn > *, .mewby-center-btn > *, .aria-btn-center > * {
      margin-left: 0 !important;
      margin-right: 0 !important;
      display: block;
      text-align: center;
    }
    .star-canvas {
      position: absolute;
      left: 0; top: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }
    .memory-fragment {
      width: 22px;
      height: 22px;
      margin: 5px;
      display: block;
      background: linear-gradient(145deg, #fffbe3 30%, #fcd34d 80%);
      border-radius: 50%;
      animation: glow 1.9s infinite alternate;
      cursor: pointer;
      box-shadow: 0 0 8px #fffbe3, 0 0 18px #ffe764;
      transition: box-shadow 0.15s, background 0.15s, border-color 0.15s;
      outline: 1.5px solid #fffbe3;
      outline-offset: 2px;
      border: 2px solid #ffe764;
      background-clip: padding-box;
    }
    .memory-fragment.visited {
      opacity: 0.22;
      pointer-events: none;
      background: #282840;
      border: 2px solid #ffe764;
    }
    #memoryFragments {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
      max-width: 120px;
      margin: 0 auto;
      text-align: center;
    }
    #memoryInfoBox {
      margin-top: 18px;
      margin-bottom: 0;
      min-height: 54px;
      background: rgba(38,39,80,0.28);
      border: 1px solid #ffe76444;
      border-radius: 8px;
      box-shadow: 0 0 7px #ffe76422;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      max-width: 230px;
      padding: 13px 10px 13px 10px;
      text-align: center;
      transition: background 0.15s, border 0.15s, opacity 0.3s;
      font-size: 11px;
      opacity: 1;
    }
    #memoryInfoBox.visible {
      display: flex;
      opacity: 1;
    }
    .memory-info-title {
      font-size: 11px;
      font-weight: bold;
      color: #ffe764;
      letter-spacing: 0.4px;
      margin-bottom: 10px;
      text-align: center;
      text-shadow: 0 0 2px #fffbe3;
      display: block;
    }
    .memory-info-desc {
      font-size: 11px;
      color: #fffbe3;
      line-height: 1.7;
      letter-spacing: 0.2px;
      text-align: center;
      font-weight: normal;
      display: block;
      margin-bottom: 0;
      margin-top: 0;
    }
    .aria-box {
      background: rgba(38, 39, 80, 0.56);
      border-radius: 7px;
      padding: 10px 8px 12px 8px;
      margin: 14px 0 0 0;
      box-shadow: 0 0 7px #ffe76422;
      font-size: 10px;
      color: #ffeebc;
      text-shadow: 0 0 4px #ffe76444, 1px 1px 0 #353a5c;
      border: 1px solid #ffe76444;
      font-family: 'Press Start 2P', monospace;
      white-space: pre-line;
      line-height: 1.5;
      max-width: 330px;
      min-width: 0;
      min-height: 90px;
      word-break: break-word;
      margin-left: auto;
      margin-right: auto;
      width: 100%;
      box-sizing: border-box;
      transition: min-height 0.3s, max-width 0.3s;
      overflow-wrap: break-word;
      text-align: center;
    }
    #ariaSprite {
      width: 44px;
      height: 44px;
      display: block;
      margin: 0 auto 7px auto;
      border-radius: 5px;
      background: #191830;
      border: 1px solid #ffe764;
      box-shadow: 0 0 10px #ffe76455, 0 0 0 1px #ffe764;
      image-rendering: pixelated;
      margin-bottom: 4px;
      text-align: center;
    }
    @keyframes glow {
      from { box-shadow: 0 0 8px #ffe764, 0 0 20px #fffbe3; }
      to { box-shadow: 0 0 16px #ffe764, 0 0 28px #fcd34d; }
    }
  </style>
</head>
<body>
  <div class="pixel-bg-stars" id="pixelBgStars"></div>

  <div class="memory-title" id="memoryTitle">Your memories with Aria</div>
  <div id="memoryInstructionLines">
    <span class="memory-instruction-quote" id="memoryInstructionQuote"></span>
  </div>

  <!-- Main pixel frame -->
  <div class="pixel-frame" id="mainFrame">
    <img src="https://64.media.tumblr.com/647ca06c5a608d1ea1c416b21b839ea3/9a98a57c72a06121-2a/s250x400/7f925df3ce70975efc97a7f0ffac27ea3838ae3e.gif"
      alt="Mewby" class="avatar" />
    <p id="mewbyGreeting" class="pixel-text" style="min-height: 1.5em"></p>
    <div id="mewbyQuoteContainer" style="width:100%;">
      <p id="mewbyQuote" class="pixel-quote"></p>
    </div>
    <div class="center-btn mewby-center-btn">
      <button class="button" id="mewbyContinue" style="display:none;">Continue</button>
    </div>
  </div>

  <!-- MEMORIES SCENE -->
  <div class="pixel-frame hidden" id="memoriesFrame">
    <canvas id="starCanvas" class="star-canvas"></canvas>
    <div id="memoryFragments"></div>
    <div id="memoryInfoBox">
      <span id="memoryInfoTitle" class="memory-info-title"></span>
      <span id="memoryInfoDesc" class="memory-info-desc"></span>
    </div>
    <div class="center-btn" id="memoriesNextBtnContainer" style="display:none;">
      <button class="button" id="memoriesNext" aria-label="Next to final scene">Next</button>
    </div>
  </div>

  <!-- Final Choice Scene -->
  <div class="pixel-frame hidden" id="finalFrame">
    <p class="pixel-text">You've remembered enough. What will you do?</p>
    <div class="center-btn">
      <button class="button" id="chooseEasyBtn" onclick="chooseEasy()">Choose Easy</button>
      <button class="button" id="chooseHerBtn" onclick="chooseHer()">Choose Her</button>
    </div>
  </div>

  <!-- Aria message frame (hidden by default) -->
  <div class="pixel-frame centered hidden" id="ariaFrame">
    <img src="https://i.imgur.com/9OC7GRw.gif" alt="Aria" id="ariaSprite" />
    <div class="aria-box" id="ariaMsg"></div>
    <div class="center-btn aria-btn-center">
      <button class="pixel-button" id="ariaHomeBtn" onclick="window.location.href='https://frdffsdx.carrd.co/#home';" style="display:none;">
        return home
      </button>
    </div>
  </div>

  <script>
    // Instruction typing animation, similar to mewbyQuoteLines
    const memoryInstructionLines = [
      "Click each memory fragment one at a time.",
      "Wait for the memory to finish before choosing the next."
    ];
    let memoryInstructionLine = 0, memoryInstructionChar = 0;
    function typeMemoryInstructionLine() {
      const el = document.getElementById('memoryInstructionQuote');
      if (memoryInstructionLine < memoryInstructionLines.length) {
        if (memoryInstructionChar < memoryInstructionLines[memoryInstructionLine].length) {
          el.textContent += memoryInstructionLines[memoryInstructionLine][memoryInstructionChar++];
          setTimeout(typeMemoryInstructionLine, 33);
        } else {
          if (memoryInstructionLine < memoryInstructionLines.length - 1) {
            el.innerHTML += '<br><br>';
          }
          memoryInstructionLine++;
          memoryInstructionChar = 0;
          setTimeout(typeMemoryInstructionLine, 250);
        }
      }
    }

    // Hide all scenes
    function showOnly(id) {
      ['mainFrame','memoriesFrame','finalFrame','ariaFrame'].forEach(x => {
        document.getElementById(x).classList.add('hidden');
      });
      document.getElementById(id).classList.remove('hidden');
      // Hide the memory lane title/instructions unless we're in memoriesFrame
      const showMemoryStuff = (id === 'memoriesFrame');
      document.getElementById('memoryTitle').style.display = showMemoryStuff ? 'block' : 'none';
      document.getElementById('memoryInstructionLines').style.display = showMemoryStuff ? 'block' : 'none';
      window.scrollTo(0,0);
    }

    // Pixel background stars
    function drawPixelStars() {
      const bg = document.getElementById('pixelBgStars');
      bg.innerHTML = '';
      let w = window.innerWidth, h = window.innerHeight;
      let n = Math.min(Math.floor(w * h / 4400), 24);
      for (let i = 0; i < n; i++) {
        const star = document.createElement('div');
        star.className = 'pixel-star';
        const left = Math.random() * 92 + 3, top = Math.random() * 83 + 8;
        star.style.left = left + 'vw';
        star.style.top = top + 'vh';
        star.style.width = star.style.height = (Math.random() < 0.75 ? 2 : 3) + 'px';
        star.style.opacity = (Math.random() * 0.7 + 0.2);
        star.style.animationDelay = (Math.random() * 2.5) + "s";
        bg.appendChild(star);
      }
    }
    window.addEventListener('resize', drawPixelStars);

    // Mewby intro typing
    const mewbyGreetingText = "Hey! Mewby is herwe!";
    const mewbyQuoteLines = [
      "We’re about to take a little walk through memories and moments between you and Aria.",
      "Click to start your journey."
    ];
    let mewbyGreetingIndex = 0, mewbyQuoteLine = 0, mewbyQuoteChar = 0;
    function typeMewbyGreeting() {
      const el = document.getElementById('mewbyGreeting');
      if (mewbyGreetingIndex < mewbyGreetingText.length) {
        el.textContent += mewbyGreetingText[mewbyGreetingIndex++];
        setTimeout(typeMewbyGreeting, 60);
      } else {
        setTimeout(() => {
          document.getElementById('mewbyQuote').textContent = ""; // reset before typing quote lines
          document.getElementById('mewbyQuoteContainer').style.display = 'block';
          typeMewbyQuoteLine();
        }, 440);
      }
    }
    function typeMewbyQuoteLine() {
      const quoteContainer = document.getElementById('mewbyQuoteContainer');
      quoteContainer.style.display = "block";
      const el = document.getElementById('mewbyQuote');
      if (mewbyQuoteLine < mewbyQuoteLines.length) {
        if (mewbyQuoteChar < mewbyQuoteLines[mewbyQuoteLine].length) {
          el.textContent += mewbyQuoteLines[mewbyQuoteLine][mewbyQuoteChar++];
          setTimeout(typeMewbyQuoteLine, 60);
        } else {
          if (mewbyQuoteLine < mewbyQuoteLines.length - 1) {
            el.innerHTML += '<br><br>';
          }
          mewbyQuoteLine++;
          mewbyQuoteChar = 0;
          setTimeout(typeMewbyQuoteLine, 400);
        }
      } else {
        setTimeout(() => {
          document.getElementById('mewbyContinue').style.display = 'inline-block';
        }, 400);
      }
    }
    window.addEventListener("DOMContentLoaded", () => {
      document.getElementById('mewbyQuoteContainer').style.display = "block";
      typeMewbyGreeting();
      drawPixelStars();
      document.getElementById('memoryTitle').style.display = "none";
      document.getElementById('memoryInstructionLines').style.display = "none";
    });

    document.getElementById('mewbyContinue').onclick = () => {
      document.getElementById('memoryInstructionQuote').innerHTML = '';
      memoryInstructionLine = 0; memoryInstructionChar = 0;
      showOnly('memoriesFrame');
      setTimeout(typeMemoryInstructionLine, 420);
      initMemories();
    };

    // MEMORY LANE DATA (v29 logic)
    const memoriesData = [
      { title: "First time we talked", desc: "That night when we stayed up late, just talking.", visited: false },
      { title: "Hospital visit", desc: "When I was sick and you stayed by my side.", visited: false },
      { title: "Long distance calls", desc: "Our endless phone calls across the miles.", visited: false },
      { title: "Work stress days", desc: "You encouraged me even on my worst days.", visited: false },
      { title: "Our first video game night", desc: "Laughing and playing like no distance existed.", visited: false },
      { title: "The first 'I love you'", desc: "That shy, unforgettable moment.", visited: false }
    ];

    let memoryInfoTimeout = null;
    let waitingForFade = false;

    function initMemories() {
      drawStars();
      const memoryFragmentsEl = document.getElementById('memoryFragments');
      const infoBox = document.getElementById('memoryInfoBox');
      const infoTitle = document.getElementById('memoryInfoTitle');
      const infoDesc = document.getElementById('memoryInfoDesc');
      const memoriesNextBtn = document.getElementById('memoriesNext');
      const memoriesNextBtnContainer = document.getElementById('memoriesNextBtnContainer');
      memoryFragmentsEl.innerHTML = '';
      infoTitle.textContent = "";
      infoDesc.textContent = "";
      infoBox.classList.remove('visible');
      infoBox.style.opacity = 1;
      waitingForFade = false;
      memoriesNextBtnContainer.style.display = "none";
      memoriesNextBtn.disabled = true;
      memoriesNextBtn.style.opacity = 0.3;
      memoriesNextBtn.setAttribute('aria-disabled', 'true');
      if (memoryInfoTimeout) clearTimeout(memoryInfoTimeout);

      memoriesData.forEach((memory, i) => memory.visited = false);

      memoriesData.forEach((memory, i) => {
        const circle = document.createElement('div');
        circle.className = 'memory-fragment';
        circle.tabIndex = 0;
        circle.setAttribute('role', 'button');
        circle.setAttribute('aria-label', `${memory.title} memory`);
        circle.dataset.index = i;

        circle.addEventListener('click', () => {
          if (memory.visited || waitingForFade) return;
          memory.visited = true;
          circle.classList.add('visited');
          waitingForFade = true;

          // Show the info box and set title/desc
          infoBox.classList.add('visible');
          infoTitle.textContent = memory.title;
          infoDesc.textContent = "";
          setTimeout(() => {
            infoDesc.textContent = memory.desc;
          }, 10);
          infoBox.style.opacity = 1;

          if (memoryInfoTimeout) clearTimeout(memoryInfoTimeout);
          memoryInfoTimeout = setTimeout(() => {
            infoBox.style.opacity = 0;
            setTimeout(() => {
              infoTitle.textContent = "";
              infoDesc.textContent = "";
              infoBox.classList.remove('visible');
              infoBox.style.opacity = 1;
              waitingForFade = false;
            }, 600);
          }, 3200);

          // If all visited, enable Next button and show last desc
          if (memoriesData.every(m => m.visited)) {
            memoriesNextBtn.disabled = false;
            memoriesNextBtn.style.opacity = 1;
            memoriesNextBtn.setAttribute('aria-disabled', 'false');
            infoTitle.textContent = "All memories revisited.";
            infoDesc.textContent = "";
            infoBox.classList.add('visible');
            infoBox.style.opacity = 1;
            memoriesNextBtnContainer.style.display = "flex";
            if (memoryInfoTimeout) clearTimeout(memoryInfoTimeout);
          }
        });

        // Keyboard accessibility: Enter or Space triggers click
        circle.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            circle.click();
          }
        });

        memoryFragmentsEl.appendChild(circle);
      });

      memoriesNextBtn.onclick = () => {
        showOnly('finalFrame');
      };
    }

    // FINAL CHOICE
    function chooseHer() {
      document.getElementById("chooseHerBtn").style.display = "none";
      document.getElementById("chooseEasyBtn").style.display = "none";
      showAriaMessage();
    }
    function chooseEasy() {
      alert("You chose the easy way out... But this story is about choosing love.");
    }

    // ARIA MESSAGE
    const ariaMessage = `You made it.

After everything.
Even after how messy things got before.

I still remember how it all fell apart —
the group, the friendships, everything.

Back then, it hurt.
And we didn’t really talk.

But somehow… you came back into my life.
And when you did,
I saw you in a way I hadn’t before.

That’s when everything changed.
That’s when we started.

And honestly…
Even if it means going through all the hard parts again,
I’d still choose this.
I’d still choose you.

Because being with you —
even on the hardest days —
means more than any easy version of life without you.

Thank you for loving me when I shut down.
When I cry out of nowhere.
When I’m not making sense.

You love me on my worst days just as much as my best —
and that means everything to me.

Some people only want love when it's simple.
But I’d go through the hard stuff all over again,
as long as it leads me to you.

You’re my home now.
My everything.

And just this once…
I hope you choose you, too.

Because I’ll keep choosing you.
Every time.

Happy Birthday.
Thank you for coming back.
Thank you for letting me love you now.`;

    function showAriaMessage() {
      showOnly('ariaFrame');
      const box = document.getElementById('ariaMsg');
      const homeBtn = document.getElementById('ariaHomeBtn');
      box.textContent = "";
      homeBtn.style.display = "none";
      let idx = 0;
      function typeAria() {
        if(idx <= ariaMessage.length){
          box.textContent = ariaMessage.substring(0, idx);
          idx++;
          setTimeout(typeAria, 60);
        } else {
          homeBtn.style.display = "inline-block";
        }
      }
      typeAria();
    }
  </script>
</body>
</html>
