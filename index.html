<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Always Choose Her</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

    body {
      margin: 0;
      padding: 0;
      background-color: #000011; /* deep navy instead of black for dreamy starry feel */
      color: white;
      font-family: 'Press Start 2P', monospace;
      overflow-x: hidden;
      text-align: center;
      user-select: none;
      position: relative;
      min-height: 100vh;
    }

    /* ---------- Starry Sky Background for Memories Scene ---------- */
    #memories {
      position: relative;
      padding-top: 40px;
      padding-bottom: 60px;
      background: radial-gradient(ellipse at center, #0a0a2a 0%, #000011 80%);
      overflow: hidden;
      z-index: 0;
      color: #fff;
      font-size: 12px;
    }
    /* A bunch of tiny white dots to simulate stars */
    #memories::before {
      content: "";
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background:
        radial-gradient(white 1.5px, transparent 2px),
        radial-gradient(white 1.5px, transparent 2px),
        radial-gradient(white 1.5px, transparent 2px);
      background-position: 5px 5px, 15px 25px, 30px 40px;
      background-size: 40px 40px;
      opacity: 0.3;
      pointer-events: none;
      animation: twinkle 4s ease-in-out infinite alternate;
      image-rendering: pixelated;
      z-index: 0;
    }

    /* Memory fragments as glowing star-like circles */
    .memory-fragment {
      width: 40px;  /* bigger for more visible */
      height: 40px;
      background: radial-gradient(circle at center, #fffacd, #fcd34d);
      border-radius: 50%;
      margin: 25px 20px;
      display: inline-block;
      animation: glow 2s infinite alternate;
      cursor: pointer;
      position: relative;
      z-index: 2;
      box-shadow: 0 0 8px #fcd34d, 0 0 20px #ffec6a;
      transition: box-shadow 0.3s ease;
      filter: drop-shadow(0 0 3px #fcd34d);
    }

    .memory-fragment:hover {
      box-shadow: 0 0 30px #fcd34d, 0 0 40px #ffec6a;
      transform: scale(1.1);
      transition: all 0.3s ease;
    }

    .memory-fragment.visited {
      opacity: 0.3;
      pointer-events: none;
      filter: none;
      transform: scale(0.9);
      box-shadow: none;
    }

    /* Tooltip style - bigger, bold for visible titles */
    #tooltip {
      font-size: 14px;
      font-weight: bold;
      color: #ffd700;
      margin-top: 15px;
      min-height: 60px;
      white-space: pre-wrap;
      animation: fadeInText 0.3s ease forwards;
      position: relative;
      z-index: 2;
      max-width: 420px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.3;
      text-shadow: 0 0 8px #ffd700aa;
      user-select: text;
      transition: opacity 0.3s ease;
    }

    /* -------- Typing effect styles for Mewby and Aria -------- */
    #mewby p {
      max-width: 420px;
      margin: 8px auto;
      font-size: 11px;
      line-height: 1.4;
      min-height: 1.4em;
      white-space: pre-wrap;
    }

    #mewby p:first-child {
      font-size: 14px;
      margin-top: 40px;
      margin-bottom: 12px;
    }

    #mewby {
      color: #eee;
      background: radial-gradient(circle at center, #001122 0%, #000011 90%);
      padding: 40px 20px;
      user-select: none;
      min-height: 250px;
      position: relative;
      z-index: 1;
    }

    /* Buttons style */
    .button, .pixel-button {
      font-family: 'Press Start 2P', monospace;
      background-color: transparent;
      color: white;
      border: 2px solid white;
      padding: 10px 20px;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
      margin-top: 30px;
      font-size: 12px;
      position: relative;
      z-index: 2;
      display: inline-block;
      margin-right: 10px;
      user-select: none;
    }

    .button:hover, .pixel-button:hover {
      background-color: #444;
      color: #ffec6a;
      border-color: #ffec6a;
    }

    /* Scenes setup */
    .scene {
      display: none;
      padding: 20px;
      position: relative;
      z-index: 1;
    }

    .visible {
      display: block;
    }

    /* Avatar images */
    .avatar, .aria-sprite {
      width: 100px;
      height: 100px;
      image-rendering: pixelated;
      position: relative;
      z-index: 2;
      margin: 20px auto 10px;
      display: block;
      filter: drop-shadow(0 0 4px #7ad);
    }

    /* Final Aria scene - dreamy pixelated background */
    #ariaScene {
      position: relative;
      padding: 30px 20px 60px;
      max-width: 480px;
      margin: 0 auto 60px;
      background:
        radial-gradient(circle at 20% 20%, #3a3a5e88, transparent 60%),
        radial-gradient(circle at 80% 70%, #5e3a5e88, transparent 60%),
        #000011;
      border: 2px solid #fff;
      border-radius: 8px;
      box-shadow: 0 0 20px #5577cc88 inset;
      user-select: none;
      color: #eee;
      font-size: 12px;
      line-height: 1.4;
      font-weight: 600;
      text-shadow: 0 0 8px #aabbffcc;
    }

    /* Sparkle animation behind Aria */
    .sparkle-bg {
      position: absolute;
      top: 10px; left: 50%;
      transform: translateX(-50%);
      width: 140px;
      height: 140px;
      pointer-events: none;
      z-index: 0;
      background:
        radial-gradient(circle 2px at 20% 30%, #fff 90%, transparent),
        radial-gradient(circle 2.5px at 70% 80%, #aaffffcc 90%, transparent),
        radial-gradient(circle 1.5px at 50% 50%, #88ddffcc 90%, transparent),
        radial-gradient(circle 1.2px at 30% 75%, #ffeeccbb 90%, transparent);
      animation: twinkle 6s ease-in-out infinite alternate;
      image-rendering: pixelated;
      filter: drop-shadow(0 0 6px #aaddffaa);
      border-radius: 50%;
    }

    /* Aria message box */
    #ariaText {
      white-space: pre-wrap;
      margin: 20px auto 0;
      max-width: 420px;
      min-height: 140px;
      font-size: 14px;
      font-weight: 600;
      text-shadow: 0 0 6px #aaccee99;
    }

    /* End Button */
    #endButton {
      margin-top: 25px;
      font-size: 12px;
      background-color: transparent;
      border-color: #ffec6a;
      color: #ffec6a;
      box-shadow: 0 0 8px #ffec6a99;
      user-select: none;
    }

    /* Typing cursor style */
    .typing-cursor {
      display: inline-block;
      width: 8px;
      height: 14px;
      background-color: #ffec6a;
      margin-left: 3px;
      animation: blink 1.2s steps(2, start) infinite;
      vertical-align: bottom;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      50.01%, 100% { opacity: 0; }
    }

    /* Animations reused */
    @keyframes glow {
      from { box-shadow: 0 0 8px #fcd34d, 0 0 20px #ffec6a; }
      to { box-shadow: 0 0 30px #fcd34d, 0 0 40px #ffec6a; }
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.7; }
    }

    @keyframes fadeInText {
      to { opacity: 1; }
    }

  </style>
</head>
<body>

  <!-- 1. MEWBY INTRO SCENE WITH TYPING EFFECT -->
  <div id="mewby" class="scene visible" aria-live="polite" role="region" aria-label="Mewby Introduction">
    <img src="https://i.imgur.com/qpJz0Ro.gif" alt="Mewby pixel avatar" class="avatar" />
    <div id="mewbyText" style="max-width: 420px; margin: 0 auto; font-size: 11px; line-height: 1.4; color: #eee;"></div>
  </div>

  <!-- 2. MEMORIES SCENE -->
  <div id="memories" class="scene" aria-live="polite" role="region" aria-label="Memories Scene">
    <h2 style="font-size: 14px; margin-bottom: 8px;">Your memories with me</h2>
    <div id="memoryFragments" style="max-width: 480px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: center; gap: 20px;">
      <!-- Memory fragments circles inserted here by JS -->
    </div>
    <div id="tooltip" aria-live="polite" role="alert" aria-atomic="true"></div>
    <button class="button" id="memoriesNext" aria-label="Next to final scene">Next</button>
  </div>

  <!-- 3. FINAL CHOOSEHER SCENE -->
  <div id="ariaScene" class="scene" aria-live="polite" role="region" aria-label="Final scene with Aria">
    <div class="sparkle-bg" aria-hidden="true"></div>
    <img src="https://i.imgur.com/9OC7GRw.gif" alt="Aria avatar" class="aria-sprite" />
    <div id="ariaText" aria-atomic="true" aria-live="polite" style="min-height: 140px;"></div>
    <button id="endButton" class="pixel-button" style="display:none;">End</button>
  </div>

  <script>
    /* ====== 1. MEWBY INTRO TYPING ====== */
    const mewbyTextEl = document.getElementById('mewbyText');
    const mewbyLines = [
      "Hey! I'm Mewby, your guide.",
      "We’re about to take a little walk through memories and moments between us.",
      "Click to start your journey."
    ];

    // Typewriter effect function for Mewby intro text
    function typeWriter(element, text, speed = 40) {
      return new Promise((resolve) => {
        let i = 0;
        element.textContent = '';
        function typing() {
          if (i < text.length) {
            element.textContent += text.charAt(i);
            i++;
            setTimeout(typing, speed);
          } else {
            resolve();
          }
        }
        typing();
      });
    }

    async function playMewbyIntro() {
      for (const line of mewbyLines) {
        await typeWriter(mewbyTextEl, line);
        await new Promise(r => setTimeout(r, 700));
      }
      // Show a blinking cursor to indicate clickable (optional)
      mewbyTextEl.innerHTML += ' <span class="typing-cursor"></span>';
    }

    // On click anywhere in #mewby, go to memories scene
    document.getElementById('mewby').addEventListener('click', () => {
      document.getElementById('mewby').classList.remove('visible');
      document.getElementById('memories').classList.add('visible');
      initMemories();
    });

    playMewbyIntro();

    /* ====== 2. MEMORIES SCENE ====== */
    const memoriesData = [
      { title: "First time we talked", desc: "That night when we stayed up late, just talking.", visited: false },
      { title: "Hospital visit", desc: "When I was sick and you stayed by my side.", visited: false },
      { title: "Long distance calls", desc: "Our endless phone calls across the miles.", visited: false },
      { title: "Work stress days", desc: "You encouraged me even on my worst days.", visited: false },
      { title: "Our first video game night", desc: "Laughing and playing like no distance existed.", visited: false },
      { title: "The first 'I love you'", desc: "That shy, unforgettable moment.", visited: false },
    ];

    const memoryFragmentsEl = document.getElementById('memoryFragments');
    const tooltipEl = document.getElementById('tooltip');
    const memoriesNextBtn = document.getElementById('memoriesNext');

    function initMemories() {
      memoryFragmentsEl.innerHTML = '';
      memoriesData.forEach((memory, i) => {
        const circle = document.createElement('div');
        circle.className = 'memory-fragment';
        circle.tabIndex = 0;
        circle.setAttribute('role', 'button');
        circle.setAttribute('aria-label', `${memory.title} memory`);
        circle.dataset.index = i;

        circle.addEventListener('mouseenter', () => {
          if (!memory.visited) {
            tooltipEl.textContent = memory.title;
            tooltipEl.style.opacity = '1';
          }
        });
        circle.addEventListener('mouseleave', () => {
          if (!memory.visited) {
            tooltipEl.textContent = '';
            tooltipEl.style.opacity = '0.5';
          }
        });

        circle.addEventListener('click', () => {
          if (memory.visited) return;
          memory.visited = true;
          circle.classList.add('visited');
          tooltipEl.textContent = memory.desc;
          tooltipEl.style.opacity = '1';

          // If all visited, enable Next button
          if (memoriesData.every(m => m.visited)) {
            memoriesNextBtn.disabled = false;
            memoriesNextBtn.style.opacity = 1;
            memoriesNextBtn.setAttribute('aria-disabled', 'false');
          }
        });

        // Keyboard accessibility: Enter or Space triggers click
        circle.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            circle.click();
          }
        });

        memoryFragmentsEl.appendChild(circle);
      });

      memoriesNextBtn.disabled = true;
      memoriesNextBtn.style.opacity = 0.3;
      memoriesNextBtn.setAttribute('aria-disabled', 'true');

      memoriesNextBtn.addEventListener('click', () => {
        document.getElementById('memories').classList.remove('visible');
        startAriaScene();
      });
    }

    /* ====== 3. FINAL CHOOSEHER SCENE TYPING SEQUENCE ====== */
    const ariaTextEl = document.getElementById('ariaText');
    const endButton = document.getElementById('endButton');
    const ariaScene = document.getElementById('ariaScene');

    const ariaMessages = [
      "You are the strongest person I've ever met.",
      "You put others before yourself every single day.",
      "Even when it hurts you.",
      "I wish you would choose yourself sometimes.",
      "But know this:",
      "I will always choose you.",
      "No matter the distance, the hardships, or the silence.",
      "You are my heart's home.",
      "And I am grateful for you.",
      "Always."
    ];

    // Typewriter function for aria messages with cursor
    function typeWriterAria(text, speed = 40) {
      return new Promise((resolve) => {
        let i = 0;
        ariaTextEl.textContent = '';
        const cursor = document.createElement('span');
        cursor.className = 'typing-cursor';
        ariaTextEl.appendChild(cursor);

        function typing() {
          if (i < text.length) {
            ariaTextEl.textContent = text.substring(0, i + 1);
            ariaTextEl.appendChild(cursor);
            i++;
            setTimeout(typing, speed);
          } else {
            resolve();
          }
        }
        typing();
      });
    }

    async function playAriaMessages() {
      for (const line of ariaMessages) {
        await typeWriterAria(line);
        await new Promise(r => setTimeout(r, 700));
      }
      endButton.style.display = 'inline-block';
      endButton.focus();
    }

    function startAriaScene() {
      ariaScene.classList.add('visible');
      playAriaMessages();
    }

    endButton.addEventListener('click', () => {
      alert("Thank you for viewing this gift. Always choose love ❤️");
      // Optionally restart or close
    });
  </script>
</body>
</html>
