<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Always Choose Her</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
    html, body {
      min-height: 100vh;
      min-width: 100vw;
      background: radial-gradient(ellipse at 50% 75%, #232323 0%, #000 100%);
      color: #fff;
      font-family: 'Press Start 2P', monospace;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background-image:
        repeating-linear-gradient(0deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 8px),
        repeating-linear-gradient(90deg, rgba(255,255,255,0.015) 0 1px, transparent 1px 8px);
      min-height: 100vh;
      min-width: 100vw;
    }
    .hidden { display: none !important; }
    .memory-title {
      font-size: 13px;
      color: #fff;
      text-shadow: 0 0 8px #fff, 0 0 4px #fff;
      font-family: 'Press Start 2P', monospace;
      font-weight: bold;
      letter-spacing: 1.2px;
      margin-bottom: 11px;
      margin-top: 24px;
      text-align: center;
      user-select: none;
    }
    .pixel-frame {
      background: #181818;
      border-radius: 16px;
      box-shadow: 0 0 0 3px #fff8, 0 0 0 6px #222, 0 0 50px 8px #0007, 0 0 0 1.5px #fff;
      max-width: 370px;
      width: 100%;
      margin: 0 auto;
      margin-top: 0;
      margin-bottom: 25px;
      image-rendering: pixelated;
      padding: 28px 18px 24px 18px;
      box-sizing: border-box;
      position: relative;
      display: block;
    }
    @media (max-width: 500px) {
      .pixel-frame { max-width: 98vw; padding: 7vw 1vw; }
    }
    .avatar {
      width: 64px;
      height: 64px;
      display: block;
      margin: 0 auto 16px auto;
      border-radius: 8px;
      box-shadow: 0 0 12px #fff6, 0 0 0 2px #fff;
      border: 1px solid #fff;
      background: #222;
      image-rendering: pixelated;
    }
    .pixel-text {
      color: #fff;
      text-shadow: 1px 1px 0 #232323, 0 0 7px #fff6;
      font-size: 0.8em;
      margin: 0.7em 0 0.4em 0;
      line-height: 1.6;
      letter-spacing: 1.1px;
      font-family: 'Press Start 2P', monospace;
      word-break: break-word;
    }
    .pixel-quote {
      color: #fff;
      font-size: 0.72em;
      margin-top: 1.3em;
      margin-bottom: 0.6em;
      text-shadow: 1px 1px 0 #232323, 0 0 7px #fff;
      background: rgba(38, 39, 80, 0.18);
      border-radius: 4px;
      padding: 7px 11px;
      border: 1px solid #fff3;
      display: inline-block;
      font-style: italic;
      image-rendering: pixelated;
    }
    .button, .pixel-button {
      font-family: 'Press Start 2P', monospace;
      background: #232323;
      color: #fff;
      border: 2px solid #fff;
      border-radius: 6px;
      box-shadow: 0 2px 0 0 #111, 0 0 8px #fff2 inset;
      padding: 5px 13px 6px 13px;
      cursor: pointer;
      margin: 18px 0 0 0;
      font-size: 11px;
      font-weight: bold;
      letter-spacing: 1.1px;
      text-shadow: 1px 1px 0 #000, 0 0 4px #fff;
      transition: background 0.16s, color 0.13s, border-color 0.13s, transform 0.07s;
      image-rendering: pixelated;
      position: relative;
      z-index: 1;
      outline: 0;
      min-width: 88px;
      min-height: 32px;
      text-align: center;
      display: inline-block;
    }
    .button:hover, .pixel-button:hover {
      background: #fff;
      color: #111;
      border-color: #fff;
      transform: scale(1.07) translateY(-1px);
      box-shadow: 0 0 14px #fff, 0 3px 0 0 #232323;
    }
    .star-canvas {
      position: absolute;
      left: 0; top: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }
    .memory-fragment {
      width: 26px;
      height: 26px;
      background: linear-gradient(145deg, #fff 30%, #bbb 80%);
      border-radius: 50%;
      margin: 14px 10px;
      display: inline-block;
      animation: glow 1.9s infinite alternate;
      cursor: pointer;
      position: relative;
      z-index: 2;
      box-shadow: 0 0 9px #fff, 0 0 20px #fff4;
      transition: box-shadow 0.3s, transform 0.2s;
      outline: 1.5px solid #fff;
      outline-offset: 2px;
    }
    .memory-fragment:hover, .memory-fragment:focus {
      box-shadow: 0 0 18px #fff, 0 0 28px #fff;
      transform: scale(1.09);
      z-index: 3;
    }
    .memory-fragment.visited {
      opacity: 0.22;
      pointer-events: none;
      box-shadow: none;
      outline: 1px dashed #fff;
      background: #444;
      transition: opacity 0.5s;
    }
    #memoryFragments {
      max-width: 220px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      z-index: 2;
      position: relative;
    }
    #tooltip {
      font-size: 12px;
      color: #fff;
      margin-top: 14px;
      min-height: 26px;
      white-space: pre-wrap;
      text-shadow: 0 0 4px #fff;
      letter-spacing: 1px;
      background: rgba(32, 32, 32, 0.85);
      border-radius: 7px;
      padding: 12px 14px;
      border: 1px solid #fff;
      box-shadow: 0 0 7px #fff2;
      display: none;
      max-width: 240px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.44;
      opacity: 0.98;
      text-align: center;
      transition: opacity 0.2s, display 0.2s;
    }
    #tooltip.active {
      display: block;
      opacity: 1;
    }
    .aria-box {
      background: #191919e0;
      border-radius: 7px;
      padding: 17px 14px 17px 14px;
      margin: 14px 0 0 0;
      box-shadow: 0 0 7px #fff1;
      font-size: 12px;
      color: #fff;
      text-shadow: 0 0 4px #fff4, 1px 1px 0 #232323;
      border: 1px solid #fff3;
      font-family: 'Press Start 2P', monospace;
      white-space: pre-line;
      line-height: 1.55;
      max-width: 330px;
      min-width: 0;
      min-height: 90px;
      word-break: break-word;
      margin-left: auto;
      margin-right: auto;
      width: 100%;
      box-sizing: border-box;
      transition: min-height 0.3s, max-width 0.3s;
      overflow-wrap: break-word;
      text-align: center;
    }
    #ariaSprite {
      width: 54px;
      height: 54px;
      display: block;
      margin: 0 auto 7px auto;
      border-radius: 5px;
      background: #222;
      border: 1px solid #fff;
      box-shadow: 0 0 10px #fff5, 0 0 0 1px #fff;
      image-rendering: pixelated;
    }
    @keyframes glow {
      from { box-shadow: 0 0 8px #fff, 0 0 20px #fff; }
      to { box-shadow: 0 0 16px #fff, 0 0 28px #bbb; }
    }
  </style>
</head>
<body>
  <div class="pixel-bg-stars" id="pixelBgStars"></div>
  <!-- Memory Lane Title OUTSIDE the box -->
  <div class="memory-title" id="memoryTitle" style="display:none;">Your memories with me</div>

  <!-- Main pixel frame -->
  <div class="pixel-frame" id="mainFrame">
    <img src="https://64.media.tumblr.com/647ca06c5a608d1ea1c416b21b839ea3/9a98a57c72a06121-2a/s250x400/7f925df3ce70975efc97a7f0ffac27ea3838ae3e.gif"
      alt="Mewby" class="avatar" />
    <p id="mewbyGreeting" class="pixel-text" style="min-height: 1.5em"></p>
    <p id="mewbyQuote" class="pixel-quote"></p>
    <button class="button" id="mewbyContinue" style="display:none;">Continue</button>
  </div>

  <!-- MEMORIES SCENE -->
  <div class="pixel-frame hidden" id="memoriesFrame">
    <canvas id="starCanvas" class="star-canvas"></canvas>
    <div id="memoryFragments"></div>
    <div id="tooltip" aria-live="polite" role="alert" aria-atomic="true"></div>
    <button class="button" id="memoriesNext" aria-label="Next to final scene" style="opacity:0.3;" disabled>Next</button>
  </div>

  <!-- Final Choice Scene -->
  <div class="pixel-frame hidden" id="finalFrame">
    <p class="pixel-text">You've remembered enough. What will you do?</p>
    <button class="button" id="chooseEasyBtn" onclick="chooseEasy()">Choose Easy</button>
    <button class="button" id="chooseHerBtn" onclick="chooseHer()">Choose Her</button>
  </div>

  <!-- Aria message frame (hidden by default) -->
  <div class="pixel-frame centered hidden" id="ariaFrame">
    <img src="https://i.imgur.com/9OC7GRw.gif" alt="Aria" id="ariaSprite" />
    <div class="aria-box" id="ariaMsg"></div>
    <button class="pixel-button" id="ariaHomeBtn" onclick="window.location.href='https://frdffsdx.carrd.co/#home';" style="margin-top:16px; display:none;">
      return home
    </button>
  </div>

  <script>
    // Hide all scenes
    function showOnly(id) {
      ['mainFrame','memoriesFrame','finalFrame','ariaFrame'].forEach(x => {
        document.getElementById(x).classList.add('hidden');
      });
      document.getElementById(id).classList.remove('hidden');
      // Show the memory lane title only when in memory scene
      document.getElementById('memoryTitle').style.display = (id === 'memoriesFrame') ? 'block' : 'none';
      window.scrollTo(0,0);
    }

    // Pixel background stars
    function drawPixelStars() {
      const bg = document.getElementById('pixelBgStars');
      bg.innerHTML = '';
      let w = window.innerWidth, h = window.innerHeight;
      let n = Math.min(Math.floor(w * h / 4400), 24);
      for (let i = 0; i < n; i++) {
        const star = document.createElement('div');
        star.className = 'pixel-star';
        const left = Math.random() * 92 + 3, top = Math.random() * 83 + 8;
        star.style.left = left + 'vw';
        star.style.top = top + 'vh';
        star.style.width = star.style.height = (Math.random() < 0.75 ? 2 : 3) + 'px';
        star.style.opacity = (Math.random() * 0.7 + 0.2);
        star.style.animationDelay = (Math.random() * 2.5) + "s";
        bg.appendChild(star);
      }
    }
    window.addEventListener('resize', drawPixelStars);

    // Mewby intro typing
    const mewbyGreetingText = "Hey! Mewby is herwe!";
    const mewbyQuoteText = "We’re about to take a little walk through memories and moments between you and Aria.\nClick to start your journey.";
    let mewbyGreetingIndex = 0, mewbyQuoteIndex = 0;
    function typeMewbyGreeting() {
      const el = document.getElementById('mewbyGreeting');
      if (mewbyGreetingIndex < mewbyGreetingText.length) {
        el.textContent += mewbyGreetingText[mewbyGreetingIndex++];
        setTimeout(typeMewbyGreeting, 30);
      } else {
        setTimeout(() => { typeMewbyQuote(); }, 440);
      }
    }
    function typeMewbyQuote() {
      const el = document.getElementById('mewbyQuote');
      if (mewbyQuoteIndex < mewbyQuoteText.length) {
        el.textContent += mewbyQuoteText[mewbyQuoteIndex++];
        setTimeout(typeMewbyQuote, 17);
      } else {
        setTimeout(() => {
          document.getElementById('mewbyContinue').style.display = 'inline-block';
        }, 400);
      }
    }
    window.addEventListener("DOMContentLoaded", () => {
      typeMewbyGreeting();
      drawPixelStars();
      document.getElementById('memoryTitle').style.display = "none";
    });

    document.getElementById('mewbyContinue').onclick = () => {
      showOnly('memoriesFrame');
      initMemories();
    };

    // MEMORY LANE DATA
    const memoriesData = [
      { title: "First time we talked", desc: "That night when we stayed up late, just talking.", visited: false },
      { title: "Hospital visit", desc: "When I was sick and you stayed by my side.", visited: false },
      { title: "Long distance calls", desc: "Our endless phone calls across the miles.", visited: false },
      { title: "Work stress days", desc: "You encouraged me even on my worst days.", visited: false },
      { title: "Our first video game night", desc: "Laughing and playing like no distance existed.", visited: false },
      { title: "The first 'I love you'", desc: "That shy, unforgettable moment.", visited: false }
    ];

    function drawStars() {
      const canvas = document.getElementById('starCanvas');
      if (!canvas) return;
      const parent = document.getElementById('memoriesFrame');
      canvas.width = parent.offsetWidth;
      canvas.height = 180;
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0,0,canvas.width,canvas.height);

      for (let i = 0; i < 40; i++) {
        const x = Math.random() * canvas.width;
        const y = Math.random() * canvas.height * 0.9 + 5;
        const size = Math.random() < 0.8 ? 2 : 4;
        ctx.save();
        ctx.globalAlpha = Math.random() * 0.4 + 0.5;
        ctx.fillStyle = "#fff";
        ctx.beginPath();
        ctx.arc(Math.floor(x), Math.floor(y), size, 0, 2 * Math.PI);
        ctx.fill();
        ctx.restore();
      }
    }
    window.addEventListener('resize', drawStars);

    function initMemories() {
      drawStars();
      const memoryFragmentsEl = document.getElementById('memoryFragments');
      const tooltipEl = document.getElementById('tooltip');
      const memoriesNextBtn = document.getElementById('memoriesNext');
      memoryFragmentsEl.innerHTML = '';
      tooltipEl.textContent = '';
      tooltipEl.classList.remove('active');

      let descTimeout = null;

      memoriesData.forEach((memory, i) => {
        const circle = document.createElement('div');
        circle.className = 'memory-fragment';
        circle.tabIndex = 0;
        circle.setAttribute('role', 'button');
        circle.setAttribute('aria-label', `${memory.title} memory`);
        circle.dataset.index = i;

        circle.addEventListener('mouseenter', () => {
          if (!memory.visited) {
            if (descTimeout) clearTimeout(descTimeout);
            tooltipEl.textContent = memory.title;
            tooltipEl.classList.add('active');
            tooltipEl.style.display = "block";
          }
        });
        circle.addEventListener('mouseleave', () => {
          if (!memory.visited) {
            if (descTimeout) clearTimeout(descTimeout);
            tooltipEl.classList.remove('active');
            tooltipEl.textContent = '';
            tooltipEl.style.display = "none";
          }
        });

        circle.addEventListener('click', () => {
          if (memory.visited) return;
          memory.visited = true;
          circle.classList.add('visited');
          tooltipEl.textContent = memory.desc;
          tooltipEl.classList.add('active');
          tooltipEl.style.display = "block";
          if (descTimeout) clearTimeout(descTimeout);
          // After 2s, if not all visited, revert to title if still hovered, else hide
          descTimeout = setTimeout(() => {
            if (!memoriesData.every(m => m.visited)) {
              if (circle.matches(':hover')) {
                tooltipEl.textContent = memory.title;
                tooltipEl.classList.add('active');
                tooltipEl.style.display = "block";
              } else {
                tooltipEl.classList.remove('active');
                tooltipEl.textContent = '';
                tooltipEl.style.display = "none";
              }
            }
          }, 2000);

          if (memoriesData.every(m => m.visited)) {
            memoriesNextBtn.disabled = false;
            memoriesNextBtn.style.opacity = 1;
            memoriesNextBtn.setAttribute('aria-disabled', 'false');
            tooltipEl.textContent = "All memories revisited.";
            tooltipEl.classList.add('active');
            tooltipEl.style.display = "block";
          }
        });
        circle.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            circle.click();
          }
        });
        memoryFragmentsEl.appendChild(circle);
      });

      memoriesNextBtn.disabled = true;
      memoriesNextBtn.style.opacity = 0.3;
      memoriesNextBtn.setAttribute('aria-disabled', 'true');
      memoriesNextBtn.onclick = () => {
        showOnly('finalFrame');
      };
    }

    // FINAL CHOICE
    function chooseHer() {
      document.getElementById("chooseHerBtn").style.display = "none";
      document.getElementById("chooseEasyBtn").style.display = "none";
      showAriaMessage();
    }
    function chooseEasy() {
      alert("You chose the easy way out... But this story is about choosing love.");
    }

    // ARIA MESSAGE
    const ariaMessage = `You made it.

After everything.
Even after how messy things got before.

I still remember how it all fell apart —
the group, the friendships, everything.

Back then, it hurt.
And we didn’t really talk.

But somehow… you came back into my life.
And when you did,
I saw you in a way I hadn’t before.

That’s when everything changed.
That’s when we started.

And honestly…
Even if it means going through all the hard parts again,
I’d still choose this.
I’d still choose you.

Because being with you —
even on the hardest days —
means more than any easy version of life without you.

Thank you for loving me when I shut down.
When I cry out of nowhere.
When I’m not making sense.

You love me on my worst days just as much as my best —
and that means everything to me.

Some people only want love when it's simple.
But I’d go through the hard stuff all over again,
as long as it leads me to you.

You’re my home now.
My everything.

And just this once…
I hope you choose you, too.

Because I’ll keep choosing you.
Every time.

Happy Birthday.
Thank you for coming back.
Thank you for letting me love you now.`;

    function showAriaMessage() {
      showOnly('ariaFrame');
      const box = document.getElementById('ariaMsg');
      const homeBtn = document.getElementById('ariaHomeBtn');
      box.textContent = "";
      homeBtn.style.display = "none";
      let idx = 0;
      function typeAria() {
        if(idx <= ariaMessage.length){
          box.textContent = ariaMessage.substring(0, idx);
          idx++;
          setTimeout(typeAria, 60);
        } else {
          homeBtn.style.display = "inline-block";
        }
      }
      typeAria();
    }
  </script>
</body>
</html>
